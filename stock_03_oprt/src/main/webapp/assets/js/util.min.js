var winWidth=0;var winHeight=0;function findDimensions(){if(window.innerWidth){winWidth=window.innerWidth}else{if((document.body)&&(document.body.clientWidth)){winWidth=document.body.clientWidth}}if(window.innerHeight){winHeight=window.innerHeight}else{if((document.body)&&(document.body.clientHeight)){winHeight=document.body.clientHeight}}if(document.documentElement&&document.documentElement.clientHeight&&document.documentElement.clientWidth){winHeight=document.documentElement.clientHeight;winWidth=document.documentElement.clientWidth}}function isNullOrUndefined(a){if(a==null||a==""||a==undefined){return true}else{return false}}function modal(b,a){console.log(b);b.preventDefault();$remote=a.remote||a.href,$modal=$('<div class="modal" id="ajaxModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});if($remote.indexOf("?")>-1){$remote+="&t="+(new Date()).valueOf()}else{$remote+="?t="+(new Date()).valueOf()}$modal.load($remote)}function modalHref(b,a){$modal=$('<div class="modal example-modal-lg" id="'+a+'"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});if(b==undefined){b=""}if(b.indexOf("?")>-1){b+="&"+(new Date()).valueOf()}else{b+="?"+(new Date()).valueOf()}console.log(b);$modal.load(b)}function closeModal(a){$("#"+a).modal("hide");$("#"+a).remove()}function cmpPicker(){modalHref(ctx+"/cmp/picker","ajaxModal")}function corpSelect(){modalHref(ctx+"/corp/corpSelector","corpModal")}function accountPicker(a){if(isNullOrUndefined(a)){a==1}modalHref(ctx+"/system/account/accountPicker?type="+a,"ajaxModal")}function uploadWords(b,c,a){b.preventDefault();$remote=ctx+"/attach/upload/words?attachField="+c+"&attachDivId="+a,$modal=$('<div class="modal" id="filesModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function uploadOneFileComplete(d,c,b,f,e){$("#contractAttach").val(b);$("#contractAttach").trigger("input:changed",b);var g=ctx+"/attach/download?attachId="+d;var a=f;if(typeof(readonly)=="undefined"){readonly=false}var h='  <div style="padding:15px;float:left;">    <div>';if(!isImageType(e)){h+="    <img src="+ctx+'"/assets/images/upload.png"  style="height:150px;" />'}else{h+='    <img src="'+g+'" data-high-res-src="'+g+'" class="gallery-items"  style="height:150px"  />'}h+='    </div>    <div style="margin-top:5px;">'+a+'</div>    <div class="text-left" style="height:25px">      <a class="btn btn-white btn-bitbucket btn-xs" href="'+g+'" target="_blank">        <i class="fa fa-download"></i> 下载      </a>';if(!readonly){h+='      <a class="btn btn-white btn-bitbucket btn-xs" onclick="_removeAttach(\''+b+"','"+a+"','"+d+'\')">        <i class="fa fa-trash"></i> 删除      </a>'}h+="    </div>  </div>";$("#"+c).html('<div class="file-box" name="'+d+'" id="attachDiv_'+b+'">'+h+"</div>");if($("#attachError")){$("#attachError").remove();if($("#btnSubmit")){$("#attachError").removeAttr("disabled")}}}function uploadFile(e,c,d,b,a){if(isNullOrUndefined(d)){d=1}if(isNullOrUndefined(b)){b="a"}if(isNullOrUndefined(a)){a="m"}$remote=ctx+"/attach/upload?attachField="+e+"&attachDivId="+c+"&attachNum="+d+"&fileType="+b+"&position="+a,$modal=$('<div class="modal" id="filesModal"><div class="modal-body"></div></div>');$("body").append($modal);$modal.modal({backdrop:"static",keyboard:false});$modal.load($remote)}function uploadFileComplete(b,c,j,h,i,g,l,f){var e=ctx+"/attach/download?attachId="+j;var k=ctx+"/attach/download/thumb?attachId="+j;var d=$("#"+b).val();if(d){d+=","+j}else{d=j}if(g==1){d=j}$("#"+b).val(d);$("#"+b).trigger("input:changed",d);var a='  <div style="padding: 0 0 0.5rem 1.0715rem;width: 150px;height:auto" id="attachDiv_'+j+'">    <figure class="overlay overlay-hover" style="height:135px;width:135px;">';if(!isImageType(i)){if(i=="ppt"||i=="pptx"||i=="pdf"){a+='<div class="ppt_wd" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</div>"}else{if(i=="doc"||i=="docx"){a+='<div class="word_wd" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</div>"}else{if(i=="xls"||i=="xlsx"){a+='<div class="xls_wd" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</div>"}else{if(i=="txt"){a+='<div class="txt_wd" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</div>"}else{a+=' <div class="img_wd" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</div>"}}}}}else{a+='<img class="overlay-figure gallery-items" src="'+k+'" data-high-res-src="'+e+'"  />'}a+='    <figcaption class="overlay-panel overlay-background overlay-fade overlay-icon">';if(isOnLine(i)){}else{if(i=="pdf"){}else{if(isImageType(i)){a+='<a class="icon wb-search" style="margin:0 5px;font-size:1.286rem;width:1.286rem;"  href="javascript:void(0)" onclick="clickImg(event,this)" ></a>'}else{if(isVideoType(i)){}}}}a+='  <a class="icon wb-download" style="margin:0 5px;font-size:1.286rem;width:1.286rem" href="'+e+'" target="_self" ></a>    	<a class="icon wb-close" style="margin:0 5px;font-size:1.286rem;width:1.286rem"  onclick="_removeAttach(\''+j+"','"+b+"','"+c+"','"+g+"','"+l+"','"+f+"')\"></a>";if(f=="m"){if(!isImageType(i)){a+='    	<h5 class="animation-slide-bottom" style="margin:-15px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</h5>"}}a+="    </figcaption>  </figure>";if(f=="b"){a+='<h5 class="animation-slide-bottom" style="margin:10px;text-align:center;word-wrap:break-word;display: -webkit-box;-webkit-box-orient: vertical;-webkit-line-clamp:2;overflow: hidden;">'+h+"</h5>"}a+="</div>";if(g==1){$("#"+c).html(a)}else{$("#"+c).prepend(a)}if(typeof uploadSuccess==="function"){uploadSuccess(j,b,c)}else{}}function isImageType(a){if(isNullOrUndefined(a)){return false}var b=a.toLowerCase();if("jpg"==b||"jpeg"==b||"tiff"==b||"raw"==b||"bmp"==b||"gif"==b||"png"==b){return true}return false}function isOnLine(a){if(isNullOrUndefined(a)){return false}var b=a.toLowerCase();if("doc"==b||"docx"==b||"xls"==b||"xlsx"==b||"ppt"==b||"pptx"==b){return true}return false}function isVideoType(a){if(isNullOrUndefined(a)){return false}var b=a.toLowerCase();if("mp4"==b||"webm"==b||"ogg"==b){return true}return false}function _removeAttach(k,c,d,h,l,g){if(isNullOrUndefined(h)){h=1}if(isNullOrUndefined(l)){l="a"}if(isNullOrUndefined(g)){g="m"}if(h==1){$("#"+c).val("");var a='  <div style="padding: 0 0 0.5rem 1.0715rem;width: 150px;height:auto;" >	<figure class="overlay" style="height:135px;width:135px;">	<img src='+ctx+'"/assets/images/upload.png"  class="overlay-figure" />	<figcaption class="overlay-panel overlay-background overlay-fade overlay-icon">		<a class="icon wb-upload" style="margin:0 5px;font-size:1.286rem;width:1.286rem" onclick="uploadFile(\''+c+"','"+d+"',1,'"+l+"','"+g+"')\"></a> 	</figcaption>  </figure></div>";$("#"+d).html(a);if(typeof removeAttachSuccess==="function"){removeAttachSuccess(k,c,d)}else{console.log("不存在该函数")}}else{var b=$("#"+c).val();b=b.replace(k,"");var f="";var j=b.split(",");for(var e=0;e<j.length;e++){if(!isNullOrUndefined(j[e])){if(!isNullOrUndefined(f)){f+=","}f+=j[e]}}$("#"+c).val(f);$("#attachDiv_"+k).remove();if(typeof removeMoreAttachSuccess==="function"){removeMoreAttachSuccess(k,c,d)}else{console.log("不存在该函数")}}}function clickImg(b,a){imgShow();$(a).parent().siblings().click()}function videoPlay(a,b){modalHref(ctx+"/attach/maintain/videoPlay?attachId="+a+"&type="+b,"videoPlayModal")}function registerAlertify4Local(){alertify.okBtn("确定").cancelBtn("关闭").theme("bootstrap").logPosition("top right").delay(1000)}function str2Date(h){if(isNullOrUndefined(h)||h.length<8){return null}var c=h.substring(0,4);var e=h.substring(4,6);var a=h.substring(6,8);var b=0,g=0;if(h.length>8){b=h.substring(9,11);g=h.substring(12,14)}var f=new Date();f.setFullYear(c,e-1,a);f.setHours(b);f.setMinutes(g);f.setSeconds(0);return f}function month2Str(c){if(isNullOrUndefined(c)){return""}var d=c.getFullYear();var a=c.getMonth()+1;if(a<10){a="0"+a}var b=d+""+a;return b}function plusMonth(a,c){var b=str2Date(a+"01");b.setMonth(b.getMonth()+c);return month2Str(b)}function date2String(e,b){var c=e.getFullYear();var d=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1;var a=e.getDate()<10?"0"+e.getDate():e.getDate();return c+b+d+b+a}function imgShow(){$(".gallery-items").click(function(){var c=ImageViewer();var b=this.src,a=$(this).data("high-res-img");c.show(b,a)})}function clickImg(b,a){imgShow();$(a).parent().siblings().click()}function downloadQcloudFile(a){self.location=ctx+"/attach/download/downloadQcloudFile?id="+a}function resultErr(a){console.log(a);if(a.result==1){toastr.error("用户未登录或超时，请重新登录！","用户未登录或超时",{positionClass:"toast-top-center"});if(window!=top){top.location.href=ctx+"/login"}else{location.href="/"}}else{toastr.error(a.msg,"",{positionClass:"toast-top-center"})}}function leftHeight(a){setTimeout(function(){var b=$(".panel-body").outerHeight(true);if(winHeight>b){$(".scrollable-container").css({height:(winHeight-180)+"px"})}else{$(".scrollable-container").css({height:(b)+"px"})}},a)}function downloadQcloudFile(a){self.location=ctx+"/attach/download/downloadQcloudFile?id="+a}function showAjaxLoading(){$("body").append('<div class="alertify vertical-align text-center" name="commonDialoag"><div class="vertical-align-middle loader-round-circle-self font-size-100"></div></div>')}function hideAjaxLoading(){$("div[name='commonDialoag']").remove()};